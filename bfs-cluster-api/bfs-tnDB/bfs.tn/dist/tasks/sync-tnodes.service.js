const a48_0x10a9=['__decorate','0\x20*\x20*\x20*\x20*','getOwnPropertyDescriptor','design:returntype','getAll','metadata','dbService','SyncTnodesService','upsert','@nestjs/common','create','/tnodes','object','decorate','Injectable','info','../services/db.service','message','function','sync\x20tnodes\x20from\x20','tnodeRepository','length','../lib/log','onTick','default','error','defineProperty','thisCluster','__esModule','DbService','get','cluster','design:paramtypes'];(function(_0x175f40,_0x10a9e4){const _0x414134=function(_0x35c952){while(--_0x35c952){_0x175f40['push'](_0x175f40['shift']());}};_0x414134(++_0x10a9e4);}(a48_0x10a9,0xc6));const a48_0x4141=function(_0x175f40,_0x10a9e4){_0x175f40=_0x175f40-0x0;let _0x414134=a48_0x10a9[_0x175f40];return _0x414134;};'use strict';var __decorate=this&&this[a48_0x4141('0x0')]||function(_0x19e8aa,_0xc2ba05,_0x3edea2,_0x18ddc2){var _0x296b55=arguments[a48_0x4141('0x15')],_0x2cc8ce=_0x296b55<0x3?_0xc2ba05:_0x18ddc2===null?_0x18ddc2=Object[a48_0x4141('0x2')](_0xc2ba05,_0x3edea2):_0x18ddc2,_0x394997;if(typeof Reflect===a48_0x4141('0xc')&&typeof Reflect[a48_0x4141('0xd')]==='function')_0x2cc8ce=Reflect[a48_0x4141('0xd')](_0x19e8aa,_0xc2ba05,_0x3edea2,_0x18ddc2);else for(var _0x2d2853=_0x19e8aa[a48_0x4141('0x15')]-0x1;_0x2d2853>=0x0;_0x2d2853--)if(_0x394997=_0x19e8aa[_0x2d2853])_0x2cc8ce=(_0x296b55<0x3?_0x394997(_0x2cc8ce):_0x296b55>0x3?_0x394997(_0xc2ba05,_0x3edea2,_0x2cc8ce):_0x394997(_0xc2ba05,_0x3edea2))||_0x2cc8ce;return _0x296b55>0x3&&_0x2cc8ce&&Object['defineProperty'](_0xc2ba05,_0x3edea2,_0x2cc8ce),_0x2cc8ce;};var __metadata=this&&this['__metadata']||function(_0x5263a4,_0x1f54d6){if(typeof Reflect===a48_0x4141('0xc')&&typeof Reflect[a48_0x4141('0x5')]===a48_0x4141('0x12'))return Reflect[a48_0x4141('0x5')](_0x5263a4,_0x1f54d6);};Object[a48_0x4141('0x1a')](exports,a48_0x4141('0x1c'),{'value':!![]});const common_1=require(a48_0x4141('0x9'));const schedule_1=require('@nestjs/schedule');const axios_1=require('axios');const config_1=require('../config');const log_1=require(a48_0x4141('0x16'));const tnode_repository_1=require('../repositories/tnode.repository');const db_service_1=require(a48_0x4141('0x10'));const logger=log_1['createLogger'](__filename);let SyncTnodesService=class SyncTnodesService{constructor(_0x37208d,_0xb4c113){this[a48_0x4141('0x14')]=_0x37208d;this[a48_0x4141('0x6')]=_0xb4c113;}async[a48_0x4141('0x17')](){const _0x4b1dce=await this[a48_0x4141('0x14')][a48_0x4141('0x4')]();for(const {cluster,url}of _0x4b1dce){if(cluster===config_1[a48_0x4141('0x1b')]){continue;}logger[a48_0x4141('0xf')](a48_0x4141('0x13')+cluster);const _0x140295=axios_1[a48_0x4141('0x18')][a48_0x4141('0xa')]({'baseURL':url,'timeout':0x2710});const _0x3478d1=await _0x140295[a48_0x4141('0x1e')](a48_0x4141('0xb'))['catch'](_0x466bd2=>{logger[a48_0x4141('0x19')](_0x466bd2[a48_0x4141('0x11')]);});if(!_0x3478d1){continue;}for(const _0x401122 of _0x3478d1['data']){if(_0x401122[a48_0x4141('0x1f')]===config_1[a48_0x4141('0x1b')]){continue;}try{await this[a48_0x4141('0x6')]['createClusterSchema'](_0x401122['cluster']);await this[a48_0x4141('0x14')][a48_0x4141('0x8')](_0x401122);}catch(_0x2ee93e){logger[a48_0x4141('0x19')](_0x2ee93e);}}}}};__decorate([schedule_1['Cron'](a48_0x4141('0x1')),__metadata('design:type',Function),__metadata(a48_0x4141('0x20'),[]),__metadata(a48_0x4141('0x3'),Promise)],SyncTnodesService['prototype'],a48_0x4141('0x17'),null);SyncTnodesService=__decorate([common_1[a48_0x4141('0xe')](),__metadata(a48_0x4141('0x20'),[tnode_repository_1['TnodeRepository'],db_service_1[a48_0x4141('0x1d')]])],SyncTnodesService);exports[a48_0x4141('0x7')]=SyncTnodesService;